<h1 align="center">
    ComfyUI_Dynamic_TagLoader
</h1>

## ğŸ”— Quick Links

* [English Version](./README_en.md)
* [æ—¥æœ¬èªç‰ˆ](./README_jp.md)
* [ä¸­æ–‡ç‰ˆ](./README.md)


<img width="1465" height="849" alt="ComfyUI_Dynamic_TagLoader_01" src="https://github.com/user-attachments/assets/517a9b69-e150-4ef6-aec1-b0ffcae43ab7" />

## å®‰è£èªªæ˜ (Installation)

é€²å…¥ ComfyUI custom_nodes ç›®éŒ„ï¼š

```bash
cd ComfyUI/custom_nodes/
git clone https://github.com/NineKey1028/ComfyUI_Dynamic_TagLoader.git

```

é‡æ–°å•Ÿå‹• ComfyUIã€‚

### âš¡Dynamic Tag Loader
> å¿«é€Ÿçš„è®€å–ã€æ’åº tag è³‡æ–™å¤¾ä¸­æ•´ç†å¥½çš„ .txt æ–‡ä»¶ï¼ŒåŒæ™‚æ”¯æŒ LoRa è®€å–ï¼Œèˆ‡ ğŸ”„ Dynamic Tag Iterator é€£æ¥å¾Œå¯æ”¯æŒ prompt éš¨æ©Ÿã€æ‰¹é‡è¼¸å‡º
> <details>
>    <summary><i>æ›´å¤š...</i></summary>
>
>    * **Global Prompt**ï¼šè¼¸å‡ºæ™‚æœƒè™•æ–¼æ‰€æœ‰çµ„åˆçš„ç¬¬ä¸€è¡Œã€‚
>    * **\+ Add Tag Group**ï¼šé»æ“Šæ–°å¢è®€å–çš„è³‡æ–™å¤¾ï¼Œå¯ä¾éœ€æ±‚æ·»åŠ ç„¡æ•¸å€‹çµ„åˆã€‚
>    * **Tag Group**ï¼š
>      * **Folder**ï¼šç›®å‰è®€å–çš„è³‡æ–™å¤¾ï¼Œé»æ“Šå¯æ‰“é–‹è³‡æ–™å¤¾é¸å–®åˆ‡æ›è³‡æ–™å¤¾ã€‚
>      * **File**ï¼šç›®å‰è³‡æ–™å¤¾ä¸‹æ‰€è®€å–çš„æª”æ¡ˆï¼Œé¸æ“‡ç¬¬ä¸€è¡Œ ALL é¸é …æ™‚æœƒå°‡æ­¤è³‡æ–™å¤¾ä¸­æ‰€æœ‰çš„ .txt èˆ‡å…¶å®ƒçµ„çš„ .txt é€²è¡Œçµ„åˆæ’åºä¸¦å…¨éƒ¨è¼¸å‡ºã€‚
>    * **LoRA è®€å–**ï¼šæ”¯æ´åœ¨ .txt æª”æ¡ˆæˆ– Global Prompt ä¸­ç›´æ¥ç·¨å¯« <lora:lora_name:æ¬Šé‡>ã€‚ç¯€é»æœƒè‡ªå‹•æå–èªæ³•ã€åŠ è¼‰æ¨¡å‹æ¬Šé‡ï¼Œä¸¦å¾æœ€çµ‚è¼¸å‡ºçš„æç¤ºè©ä¸­æ¸…ç†è©²èªæ³•ã€‚
>    * **å³éµé¸å–®**ï¼šåœ¨ä»»ä¸€ Tag Group å€å¡Šé»æ“Šå³éµï¼Œå¯å‘¼å«å°ˆå±¬é¸å–®é€²è¡Œã€Œä¸Šç§»/ä¸‹ç§»ã€ã€ã€Œç½®é ‚/ç½®åº•ã€ã€ã€Œå‘å‰/å‘å¾Œæ’å…¥æ–°çµ„ã€æˆ–ã€Œåˆªé™¤è©²çµ„ã€ç­‰æ’åºæ“ä½œã€‚
>    </details>

### ğŸ”„ Dynamic Tag Iterator
> æ¥æ”¶ä¾†è‡ª Dynamic Tag Loader çš„çµ„åˆåˆ—è¡¨ï¼Œä¸¦æ ¹æ“šè¨­å®šé€²è¡Œå–®æ¬¡è¿­ä»£æˆ–æ‰¹é‡è¼¸å‡ºã€‚
> <details>
>    <summary><i>æ›´å¤š...</i></summary>
>
>    * **Output Mode**ï¼š
>        * **Iterate (One by One)**ï¼šé…åˆ ComfyUI çš„éšŠåˆ—æ©Ÿåˆ¶ï¼Œæ¯æ¬¡åŸ·è¡Œåƒ…è¼¸å‡ºçµ„åˆä¸­çš„ä¸€é …ï¼ˆä¾æ“š Seed é€²è¡Œç´¢å¼•é †åºåˆ‡æ›ï¼‰ã€‚
>        * **Batch (List)**ï¼šä¸€æ¬¡æ€§è¼¸å‡ºæ‰€æœ‰çµ„åˆï¼ˆæˆ–ç¯©é¸å¾Œçš„åˆ—è¡¨ï¼‰ï¼Œé©ç”¨æ–¼æ”¯æŒ List è™•ç†çš„å¾ŒçºŒç¯€é»ã€‚
>    * **Sample Limit**ï¼šæŠ½æ¨£é™åˆ¶åŠŸèƒ½ã€‚è¨­ç‚º 0 æ™‚ä½¿ç”¨æ‰€æœ‰çµ„åˆï¼›è‹¥å¤§æ–¼ 0ï¼Œå‰‡æœƒæ ¹æ“šç›®å‰çš„ Seed å¾æ‰€æœ‰çµ„åˆä¸­éš¨æ©ŸæŠ½å–æŒ‡å®šæ•¸é‡çš„é …é€²è¡Œè¼¸å‡ºã€‚
>    * **Seed æ§åˆ¶èˆ‡è¨˜éŒ„**ï¼š
>        * ç¯€é»æœƒæ ¹æ“šè¼¸å…¥çš„ Seed æ±ºå®šè¿­ä»£çš„ç´¢å¼•æˆ–éš¨æ©ŸæŠ½æ¨£çš„é †åºã€‚
>        * **â™»ï¸ Reuse Last Seed**ï¼šUI é¢æ¿æœƒè‡ªå‹•è¨˜éŒ„ä¸Šä¸€æ¬¡æˆåŠŸåŸ·è¡Œæ™‚ä½¿ç”¨çš„ Seedã€‚é»æ“ŠæŒ‰éˆ•å¯å¿«é€Ÿå°‡è©²æ•¸å€¼å¡«å› Seed è¼¸å…¥æ¡†ï¼Œæ–¹ä¾¿å¾©ç¾ç‰¹å®šçš„éš¨æ©Ÿçµ„åˆã€‚
>    </details>

### ğŸ’¾ Dynamic Tag Saver
> å°‡ Prompt æ–‡æœ¬å³æ™‚ä¿å­˜ç‚º .txt æ¨™ç±¤æª”æ¡ˆï¼Œä¸¦è‡ªå‹•æ•´åˆæ‰€é¸çš„ LoRA èªæ³•ã€‚æ­¤ç¯€é»èƒ½å¹«åŠ©ä½¿ç”¨è€…å¿«é€Ÿå»ºç«‹å€‹äººæ¨™ç±¤åº«ï¼Œæ–¹ä¾¿æœªä¾†é€é Dynamic Tag Loader é‡æ–°è®€å–èˆ‡çµ„åˆã€‚
> <details>
>    <summary><i>æ›´å¤š...</i></summary>
>
>    * **Text Input**ï¼šä¸»è¦çš„æç¤ºè©è¼¸å…¥å€å¡Šã€‚å­˜æª”æ™‚æœƒè‡ªå‹•ç§»é™¤å‰å¾Œå¤šé¤˜ç©ºæ ¼ã€‚
>    * **Folder & Filename**ï¼š
>        * **Folder Name**ï¼šæŒ‡å®šå­˜æª”çš„è³‡æ–™å¤¾åç¨±ï¼Œè‹¥ç›®éŒ„ä¸å­˜åœ¨æœƒè‡ªå‹•å‰µå»ºï¼ˆä½æ–¼ç¯€é»ç›®éŒ„ä¸‹çš„ `tags` è³‡æ–™å¤¾ä¸­ï¼‰ã€‚
>        * **Filename**ï¼šæŒ‡å®šæª”æ¡ˆåç¨±ã€‚è‹¥è³‡æ–™å¤¾å…§å·²å­˜åœ¨åŒåæª”æ¡ˆï¼Œæœƒè‡ªå‹•æ·»åŠ æµæ°´è™Ÿï¼ˆå¦‚ `_1`, `_2`ï¼‰ï¼Œé˜²æ­¢è¦†è“‹æ—¢æœ‰è³‡æ–™ã€‚
>    * **LoRA Auto Merge (â–¼ LoRA Auto Merge â–¼)**ï¼š
>        * **+ Add LoRA**ï¼šé»æ“Šé–‹å•Ÿæœå°‹é¸å–®ï¼Œå¾ç³»çµ±ä¸­é¸æ“‡å®‰è£å¥½çš„ LoRA æª”æ¡ˆã€‚
>        * **Strength**ï¼šèª¿æ•´è©² LoRA çš„æ¬Šé‡æ•¸å€¼ï¼ˆæ”¯æ´ -10.0 è‡³ 10.0ï¼‰ã€‚
>        * **è‡ªå‹•èªæ³•æ•´åˆ**ï¼šå­˜æª”æ™‚ï¼Œç¯€é»æœƒå°‡é¸æ“‡çš„ LoRA è‡ªå‹•è½‰æ›ç‚ºæ¨™æº– Prompt èªæ³• `<lora:åç¨±:æ¬Šé‡>` ä¸¦é™„åŠ åœ¨æ–‡æœ¬æœ«ç«¯ã€‚
>    * **å³éµé€²éšé¸å–®**ï¼šåœ¨ LoRA å€å¡Šé»æ“Šå³éµï¼Œå¯é€²è¡Œã€Œç½®é ‚/ç½®åº•ã€ã€ã€Œæ’åºç§»å‹•ã€æˆ–ã€Œæ’å…¥/åˆªé™¤ã€ç­‰æ“ä½œï¼Œéˆæ´»èª¿æ•´ LoRA çš„å¯«å…¥é †åºã€‚
>    </details>

### ğŸ” Workflow Metadata Reader
> ç”¨æ–¼å¾ç”Ÿæˆçš„åœ–ç‰‡ï¼ˆPNGï¼‰ä¸­å›æº¯æå–å®Œæ•´çš„ Workflow JSON æ•¸æ“šèˆ‡ä¸¦ä¾å·¥ä½œæµIDæŠ“å–å…§å®¹ä¸¦è¼¸å‡ºpromptã€åœ–ç‰‡ã€‚æ”¯æŒå–®åœ–è§£æã€è³‡æ–™å¤¾æ‰¹é‡éš¨æ©Ÿé¸å–ã€‚
> <details>
>    <summary><i>æ›´å¤š...</i></summary>
>
>    * **image_or_dir**ï¼šå¯è¼¸å…¥åœ–ç‰‡æˆ–è³‡æ–™å¤¾è·¯å¾‘ã€‚
>    * **Search By**ï¼š
>        * **ID**ï¼šé€éç¯€é» ID å®šä½ä¸¦æå–è©²ç¯€é»çš„æ‰€æœ‰ Widget æ•¸å€¼ï¼ˆå¦‚ Promptã€Seed ç­‰ï¼‰ã€‚
>        * **Type**ï¼šé€éç¯€é»é¡å‹ï¼ˆå¦‚ `CLIPTextEncode`ï¼‰éæ¿¾ä¸¦æå–åŒ¹é…çš„æ–‡æœ¬å…§å®¹ã€‚
>    * **æª”æ¡ˆé¸å–é‚è¼¯**ï¼š
>        * **è³‡æ–™å¤¾æ¨¡å¼**ï¼šè¼¸å…¥è³‡æ–™å¤¾è·¯å¾‘ï¼Œä¸¦é…åˆ **Seed** é€²è¡Œéš¨æ©Ÿç´¢å¼•æŠ½æ¨£ï¼Œé©åˆç”¨æ–¼è‡ªå‹•åŒ–é‡æ–°è®€å–ä¸åŒåœ–ç‰‡çš„æç¤ºè©ã€‚
>        * **å–®åœ–æ¨¡å¼**ï¼šç›´æ¥è®€å–æŒ‡å®šè·¯å¾‘çš„åœ–ç‰‡è³‡è¨Šã€‚
>
>    å¯ç›´æ¥å°‡åœ–ç‰‡æª”æ¡ˆæ‹–å…¥ç¯€é»ä¸¦å¡«å¯«åœ–ç‰‡è·¯å¾‘ã€‚
>
>    å¯å¾å‰ªè²¼ç°¿ç›´æ¥ `Ctrl+V` è²¼ä¸Šåœ–ç‰‡ã€‚
> 
>    ä¸Šæ•˜å…©é …å‹•ä½œæœƒå°‡åœ–ç‰‡è¤‡è£½è‡³inputè³‡æ–™å¤¾
> 
>    âš ï¸ **æ³¨æ„äº‹é …**ï¼š
>    æ­£ç¢ºè®€å– Prompt çš„å‰ææ˜¯è©²æµç¨‹ä¸­éœ€ä½¿ç”¨é¡ä¼¼ **Show Text** çš„ç¯€é»ä¾†é¡¯ç¤ºæç¤ºè©ï¼Œä¸” **Prompt å¿…é ˆå…ˆæ–¼åœ–ç‰‡ç”¢ç”Ÿ**ï¼ˆå³å¯«å…¥ Metadata ä¸­ï¼‰ï¼Œå¦å‰‡å¯èƒ½æœƒè®€å–åˆ°éŒ¯èª¤è³‡è¨Šã€‚è‹¥é‡åˆ°åŸ·è¡Œé †åºå•é¡Œï¼Œå»ºè­°æ­é… **â³ Wait For** ç¯€é»ä¾†å¼·åˆ¶æ§åˆ¶ç”¢ç”Ÿé †åºã€‚
>    </details>

### â³ Wait For
> ç”¨æ–¼å¼·åˆ¶æ§åˆ¶å·¥ä½œæµçš„åŸ·è¡Œé †åºã€‚åœ¨ ComfyUI çš„éç·šæ€§åŸ·è¡Œç’°å¢ƒä¸­ï¼Œç¢ºä¿ç‰¹å®šç¯€é»å¿…é ˆåœ¨ã€Œç›®æ¨™ç¯€é»ã€å®Œæˆå¾Œæ‰é–‹å§‹é‹ç®—ï¼Œè§£æ±ºç•°æ­¥åŸ·è¡Œå°è‡´çš„é †åºéŒ¯èª¤å•é¡Œã€‚
> <details>
>    <summary><i>æ›´å¤š...</i></summary>
>
>    * **Data Input**ï¼šä¸»è¦æµè½‰çš„æ•¸æ“šï¼ˆæ”¯æ´ä»»ä½•é¡å‹ AnyTypeï¼‰ï¼Œæ­¤æ•¸æ“šå°‡è¢«åŸæ¨£è¼¸å‡ºã€‚
>    * **Wait For (Optional)**ï¼šé€£æ¥ä½ å¸Œæœ›å…ˆåŸ·è¡Œçš„ç¯€é»è¼¸å‡ºã€‚ç•¶æ­¤é€£æ¥é»æœ‰æ•¸æ“šå‚³å…¥æ™‚ï¼Œ`Wait For` æ‰æœƒé‡‹æ”¾ `Data Input` çµ¦å¾ŒçºŒç¯€é»ã€‚
>    </details>

ç¯„ä¾‹å·¥ä½œæµï¼š
![example](./example/Dynamic_Tag_example_workflow.png)
![example](./example/Workflow_Metadata_Reader_example_workflow.png)
å¯æ‹–å…¥ comfyUI è®€å–ç¯„ä¾‹å·¥ä½œæµ
